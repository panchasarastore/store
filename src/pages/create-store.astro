---
export const prerender = false;

import StoreTemplate from '../components/store/StoreTemplate.astro';
import { requireAuth } from '../lib/auth';
import { hasStore } from '../lib/stores';

// ----------------------------------
// Auth + routing guard
// ----------------------------------
await requireAuth(Astro);

if (await hasStore()) {
  return Astro.redirect('/dashboard');
}

// ----------------------------------
// Preview-only placeholder data
// (form wiring comes later)
// ----------------------------------
const previewStore = {
  name: 'The Sourdough Studio',
  tagline: 'Slow-fermented love from my heart to yours',
  about:
    'Every loaf I bake is a 48-hour labor of love. I began my journey in a small kitchen in Tuscany, learning the ancient art of wild yeast fermentation.',
  logo: '',
};

const previewTheme = {
  primary: '#CD5C5C',
  secondary: '#7a5c3d',
  background: '#FFFDF5',
  text: '#0e1b19',
};

const previewProducts = [];
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Create Store – Panchasara</title>

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Styles -->
    <link rel="stylesheet" href="/styles/create-store.css" />
    <link rel="stylesheet" href="/styles/store-template.css" />
  </head>

  <body>
    <div class="create-store-layout">
      <!-- ===================================================
           LEFT PANEL — CREATE STORE FORM
           =================================================== -->
      <section class="form-panel">
        <div class="form-container">
          <!-- Page Header -->
          <header class="page-header">
            <h1>Create Your Store</h1>
            <p>Set up your artisan storefront</p>
          </header>

          <form class="store-form">
            <!-- =====================
                 STORE BASICS
                 ===================== -->
            <section class="form-section">
              <h2>Store Basics</h2>

              <label>
                Store Name *
                <input
                  type="text"
                  name="store_name"
                  placeholder="The Sourdough Studio"
                  required
                />
              </label>

              <label>
                Store URL *
                <div class="url-input">
                  <span>panchasara.com/</span>
                  <input
                    type="text"
                    name="store_url_slug"
                    placeholder="sourdough-studio"
                    required
                  />
                </div>
              </label>
            </section>

            <!-- =====================
                 BRAND VOICE
                 ===================== -->
            <section class="form-section">
              <h2>Brand Voice</h2>

              <label>
                Tagline
                <input
                  type="text"
                  name="store_tagline"
                  placeholder="Slow-fermented love from my kitchen"
                />
              </label>

              <label>
                About the Store
                <textarea
                  name="about_us"
                  rows="5"
                  placeholder="Tell your story…"
                ></textarea>
              </label>
            </section>

            <!-- =====================
                 VISUAL IDENTITY — COLORS
                 ===================== -->
            <section class="form-section">
              <h2>Visual Identity – Colors</h2>

              <div class="color-grid">
                <label>
                  Primary
                  <input type="color" name="color_primary" value="#CD5C5C" />
                </label>

                <label>
                  Secondary
                  <input type="color" name="color_secondary" value="#7a5c3d" />
                </label>

                <label>
                  Background
                  <input type="color" name="color_background" value="#FFFDF5" />
                </label>

                <label>
                  Text
                  <input type="color" name="color_text" value="#0e1b19" />
                </label>
              </div>
            </section>

            <!-- =====================
                 VISUAL IDENTITY — FONTS
                 ===================== -->
            <section class="form-section">
              <h2>Visual Identity – Fonts</h2>

              <div class="font-options">
                <label>
                  <input type="radio" name="font_preset" value="classic" checked />
                  Playfair Display + Inter
                </label>

                <label>
                  <input type="radio" name="font_preset" value="modern" />
                  Poppins + Inter
                </label>

                <label>
                  <input type="radio" name="font_preset" value="minimal" />
                  Inter only
                </label>
              </div>
            </section>

            <!-- =====================
                 STORE TEMPLATE
                 ===================== -->
            <section class="form-section">
              <h2>Store Layout</h2>

              <div class="template-options">
                <label>
                  <input type="radio" name="template" value="classic" checked />
                  Classic
                </label>

                <label>
                  <input type="radio" name="template" value="minimal" />
                  Minimal
                </label>

                <label>
                  <input type="radio" name="template" value="bold" />
                  Bold
                </label>
              </div>
            </section>

            <!-- =====================
                 LOGO UPLOAD
                 ===================== -->
            <section class="form-section">
              <h2>Logo</h2>

              <input type="file" name="logo" accept="image/*" />
            </section>

            <!-- =====================
                 CONTACT & SOCIAL
                 ===================== -->
            <section class="form-section">
              <h2>Contact & Social</h2>

              <label>
                Contact Email
                <input type="email" name="contact_email" />
              </label>

              <label>
                WhatsApp Number
                <input type="tel" name="whatsapp_number" placeholder="+91…" />
              </label>

              <label>
                Instagram URL
                <input type="url" name="instagram_url" />
              </label>

              <label>
                Facebook URL
                <input type="url" name="facebook_url" />
              </label>
            </section>

            <!-- =====================
                 ACTIONS
                 ===================== -->
            <footer class="form-actions">
              <button type="button" class="btn-secondary">
                Back
              </button>

              <button type="submit" class="btn-primary">
                Save & Continue
              </button>
            </footer>
          </form>
        </div>
      </section>

      <!-- ===================================================
           RIGHT PANEL — LIVE PREVIEW
           =================================================== -->
      <section class="preview-panel">
        <div class="preview-browser">
          <div class="browser-bar">
            <div class="browser-dots">
              <span></span>
              <span></span>
              <span></span>
            </div>
            <div class="browser-url">
              sourdough-studio.panchasara.com
            </div>
          </div>

          <div class="preview-content">
            <StoreTemplate
              store={previewStore}
              theme={previewTheme}
              products={previewProducts}
              isPreview={true}
            />
          </div>
        </div>
      </section>
    </div>
  </body>
</html>
